# Система мониторинга дисциплины на занятиях

Интерактивное веб‑приложение на Streamlit для **обнаружения нарушений дисциплины** на занятиях по видеопотоку.  
Используются нейросетевые модели:

- YOLO (Ultralytics) — детекция объектов/нарушений;
- InsightFace — детекция и распознавание лиц.

Приложение умеет работать с **веб‑камерой**, **загруженным видеофайлом** и формировать **отчёты о нарушениях**.

---

## Структура проекта

```
monitoring_app/
│
├── app.py                    # Главный файл Streamlit
├── config.py                 # Настройки путей и параметров моделей
├── models/
│   ├── __init__.py
│   ├── yolo_detector.py      # Класс-обёртка над YOLO
│   └── face_recognition.py   # Класс для работы с InsightFace
├── utils/
│   ├── __init__.py
│   ├── video_processor.py    # Обработка видеопотока, сбор нарушений
│   ├── report_generator.py   # CSV, графики и текстовый отчёт
│   └── visualization.py      # Доп. функции визуализации 
├── pages/
│   ├── 1_Webcam.py         # Мониторинг с веб‑камеры
│   ├── 2_Upload_Video.py   # Обработка загруженного видеофайла
│   └── 3_Statistics.py     # Просмотр статистики нарушений
└── requirements.txt          # Список зависимостей
```

---

## Установка

1. Клонировать репозиторий или скопировать папку проекта:

```
cd monitoring_app
```

2. Создать и активировать виртуальное окружение (Python 3.10):

```
python -m venv .venv
.venv\Scripts\activate
```

3. Установить зависимости:

```
pip install -r requirements.txt
```

4. Скачать/подготовить веса моделей:

- Обученный YOLO‑детектор нарушений (например, `best.pt`) положить в корень проекта.  
- При необходимости скорректировать путь к модели в `config.py`:

```
YOLO_MODEL_PATH = "best.pt"      # или "yolo11n.pt" для предобученной модели
INSIGHTFACE_MODEL = "buffalo_l"  # имя модели InsightFace
```

---

## Запуск приложения

```
streamlit run app.py
```

После запуска приложение будет доступно по адресу:  
http://localhost:8501

---

## Основные возможности

- Webcam  
  - Захват видеопотока с веб‑камеры.  
  - Онлайн‑детекция нарушений (сон, телефон и др.).  
  - Отрисовка рамок и меток на кадрах.

- Upload Video  
  - Загрузка и обработка видеофайлов (MP4, AVI, MOV, MKV).  
  - Сохранение обработанного видео (опция).  
  - Формирование:
    - CSV‑отчёта с подробным списком нарушений;
    - графика распределения нарушений по типам;
    - текстового отчёта в формате, заданном в проектной работе.

- Statistics  
  - Просмотр сводной статистики по всем зафиксированным нарушениям.  
  - Визуализация количества нарушений по типам.

## Требования

- Python 3.10  
- Streamlit  
- Ultralytics YOLO  
- OpenCV  
- InsightFace + onnxruntime  
- Прочие зависимости из `requirements.txt`


